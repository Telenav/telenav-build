#!/bin/bash

#///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#
#  Â© 2011-2021 Telenav, Inc.
#  Licensed under Apache License, Version 2.0
#
#///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

source telenav-library-functions

if [[ -z "$CACTUS_GITHUB_PERSONAL_ACCESS_TOKEN" ]]; then

    echo "Must set CACTUS_GITHUB_PERSONAL_ACCESS_TOKEN environment variable to create pull requests"
    exit 1

fi

if [[ "$#" -eq 1 ]]; then

    branch_name=$1

else

    read -r -p "Branch name? "
    branch_name=$REPLY

fi

read -r -p "Title? "
title=$REPLY
read -r -p "Body? "
body=$REPLY

cactus_all git-pull-request \
    -Dcactus.authentication-token="$CACTUS_GITHUB_PERSONAL_ACCESS_TOKEN" \
    -Dcactus.title=\""$title"\" \
    -Dcactus.to-branch=develop \
    -Dcactus.from-branch=\""${branch_name}"\" \
    -Dcactus.body=\""${body}"\" \
    -Dcactus.reviewers="rodherz,sunshine-syz,timboudreau,wenjuanj,jonathanl-telenav,haifeng-z" || exit 1
